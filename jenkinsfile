pipeline {
agent any

tools{
maven 'Maven'

}
stages{
stage('stahe1'){
steps{
  echo 'stage1: Checkout SCM'  
   checkout scm
    }
}
stage('stage2: Maven Build'){
 steps{
echo 'stage2: Maven Build'
sh 'mvn clean package -DskipTests'
}
}
stage('stage3: Docker build and push'){
steps{
sh 'whoami'
sh 'docker build -t vps17aug@gmail.com/ekart:1 .'
sh  withCredentials([usernamePassword(credentialsId: 'Docker', usernameVariable: 'DOCKER_USER', passwordVariable: 'DOCKER_PASS')]) {
                    sh '''
                        echo $DOCKER_PASS | docker login -u $DOCKER_USER --password-stdin
                        docker push vps17aug@gmail.com/ekart:1
                    '''
}
}
  }
}
}
